import{a as V,j as F,k as L,C as H,P as i}from"./index-9076ce45.js";import{r as d,bk as R,V as n,aP as m,df as M,ar as W,di as $,_ as z,dd as P,Y as O,bU as U,d1 as x,au as j,ay as I,d2 as Q,cQ as X}from"./index-3a76b207.js";import"./useLandscapeMode-e7a72966.js";const K=d.memo(l=>R(l.data)?n.createElement(m,{height:"100%"},"No data"):M(l.data)?n.createElement(n.Fragment,null,n.createElement(Y,{...l})):n.createElement(m,{height:"100%"},"Data format not support!")),Y=l=>{const{panel:e,height:f,width:b}=l,[r,S]=d.useState(null),{colorMode:p}=W();if(!M(l.data))return n.createElement(m,{height:"100%"},"Data format not support!");const c=b<X,[w,B]=d.useMemo(()=>{const s=[],g=[],E=$[l.panel.styles.palette]??z;l.data.flat().forEach((t,a)=>{const o=P(t,l.panel.plugins.pie.value.calc);s.push({name:t.name,value:o});let u;if(e.plugins.pie.enableThresholds){let v=0;e.plugins.pie.thresholds.mode==V.Percentage&&(v=P(t,O.Max));const T=F(o,e.plugins.pie.thresholds,v);T&&(u=T.color)}u||(u=E[a%E.length]),g.push(U(u))});const N=x(e.plugins.pie.onClickEvent),k=_(e),y=x(e.plugins.pie.label.transformName);let C=!1;e.plugins.pie.label.show&&(C=!c);let h=!1;(e.plugins.pie.legend.show||e.plugins.pie.label.show&&c)&&(h=!0);const D=g.length>0&&e.plugins.pie.enableThresholds&&e.plugins.pie.showThreshodBorder?!0:null;return[{animation:e.plugins.pie.animation,legend:{show:h,orient:e.plugins.pie.legend.orient,...k},tooltip:{trigger:"item",formatter:t=>`${L(t.value,e.plugins.pie.value.units,e.plugins.pie.value.decimal)}`},series:[{type:"pie",radius:[`${e.plugins.pie.shape.innerRadius}%`,`${e.plugins.pie.shape.radius}%`],center:[e.plugins.pie.left,e.plugins.pie.top],roseType:e.plugins.pie.shape.type=="rose"?"area":null,itemStyle:{borderRadius:e.plugins.pie.shape.borderRadius,opacity:.7,borderWidth:(p=="light",.5),borderColor:D},data:s,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},label:{show:C,alignTo:e.plugins.pie.label.align,minMargin:e.plugins.pie.label.margin,edgeDistance:1,opacity:1,formatter:t=>{let a="";return e.plugins.pie.label.showName&&(j.isFunction(y)?a+=y(t.data.name,t):a+=t.data.name),e.plugins.pie.label.showValue&&(R(a)||(a+=`
`),a+=L(t.data.value,e.plugins.pie.value.units,e.plugins.pie.value.decimal)),a},lineHeight:e.plugins.pie.label.lineHeight,fontSize:e.plugins.pie.label.fontSize},labelLayout:e.plugins.pie.label.show&&e.plugins.pie.label.showName&&e.plugins.pie.label.showValue&&function(t){const a=t.labelRect.x<(r==null?void 0:r.getWidth())/2,o=t.labelLinePoints;return o[2][0]=a?t.labelRect.x:t.labelRect.x+t.labelRect.width,{labelLinePoints:o}},color:g}]},N]},[e.plugins.pie,l.data,p,r,e.styles.palette,c]);return n.createElement(n.Fragment,null,w&&n.createElement(I,{height:f,key:p,className:"echarts-panel"},n.createElement(H,{options:w,theme:p,width:b,height:f,onChartCreated:s=>S(s),onChartEvents:e.plugins.pie.enableClick?s=>Q(B,s):null})))},_=l=>{switch(l.plugins.pie.legend.placement){case i.Top:return{top:"top"};case i.Bottom:return{top:"bottom"};case i.TopLeft:return{top:"top",left:"left"};case i.TopLeft:return{top:"top",left:"left"};case i.TopRight:return{top:"top",left:"right"};case i.BottomLeft:return{top:"bottom",left:"left"};case i.BottomRight:return{top:"bottom",left:"right"}}};export{K as default};
